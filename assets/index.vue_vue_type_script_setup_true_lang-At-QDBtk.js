var H=Object.defineProperty;var Q=(o,t,e)=>t in o?H(o,t,{enumerable:!0,configurable:!0,writable:!0,value:e}):o[t]=e;var R=(o,t,e)=>Q(o,typeof t!="symbol"?t+"":t,e);import{a as r,g as j,d as B,p as P,i as O,n as z,u as J,f as D,h as K,r as x,m as A,E as X,j as E,P as Y,k as Z,c as _,l as V,t as S,w as b,q as M,F as W,s as ee,o as U,b as f}from"./index-K856u5f5.js";import{Q as te}from"./index-BfofBqvL.js";class oe{constructor(){R(this,"map",new WeakMap)}getEventsMapByConsumer(t){let e=this.map.get(t);return e||(e=new Map,this.map.set(t,e)),e}getEventsByConsumer(t,e){const s=this.getEventsMapByConsumer(t);let n=s.get(e);return n||(n=new Set,s.set(e,n)),n}on(t,e,s,n={}){const l=this.getEventsByConsumer(t,e);let c=s;n.once&&(c=(...a)=>{s(...a),this.off(t,e,c)}),l.add(c),n.callAfterDelay!==void 0&&setTimeout(()=>{c()},n.callAfterDelay||0)}once(t,e,s){this.on(t,e,s,{once:!0})}emit(t,e,...s){this.getEventsByConsumer(t,e).forEach(l=>l(...s))}off(t,e,s){this.getEventsByConsumer(t,e).delete(s)}}const ne=(o="")=>o.slice(2).toLowerCase(),N=(o="")=>`on${o.charAt(0).toUpperCase()}${o.slice(1)}`,se=()=>{let o=()=>{},t=()=>{};return{promise:new Promise((s,n)=>{o=s,t=n}),resolve:o,reject:t}};var h=(o=>(o.confirm="confirm",o.cancel="cancel",o.destory="destory",o))(h||{});const le=Symbol("CommandDialogConsumerInjectKey"),F=Symbol("CommandDialogStackInjectKey"),T=new oe,$=o=>({...o.parent?$(o.parent):{},...o.provides});function q(o,t,e){const s=(typeof e.appendTo=="string"?document.querySelector(e.appendTo):e.appendTo)||document.body,n=document.createElement("div");n.className="command-commponent-container",s.appendChild(n);const l=()=>{e.visible.value=!1},c=()=>{e.visible.value=!0},a=()=>{z(()=>{j(null,n),n.remove()})},u=(d=!1)=>{d?(v.on(h.destory,a,{once:!0,callAfterDelay:3e3}),l()):v.stack.splice(v.stackIndex).forEach(C=>C.destroy(!0))},{promise:m,resolve:p,reject:i}=se(),v={promise:m,resolve:p,reject:i,destroyWithResolve:d=>{p(d),u()},destroyWithReject:d=>{i(d),u()},hide:l,show:c,destroy:u,container:n,visible:e.visible,on:(d,C,G={})=>T.on(v,d,C,G),once:(d,C)=>T.once(v,d,C),emit:(d,...C)=>T.emit(v,d,...C),off:(d,C)=>T.off(v,d,C),stack:[],stackIndex:-1,componentRef:void 0},w=r(B({setup(){for(const C in e.provideProps)P(C,e.provideProps[C]);P(le,v);const d=O(F,[]);return v.stackIndex=d.length,d.push(v),P(F,d),v.stack=d,()=>t}}),null,null);return w.appContext=(o==null?void 0:o.appContext)||w.appContext,w.appContext.provides={...w.appContext.provides,...$(o)},j(w,n),v}const I=(o=!0)=>{const t=E(),{locale:{t:e}}=J("message-box");return(n,l={})=>{const c=D(o),a=q(t,K(B({setup(){const u=D(),m=y=>{y(),a.destroy()},p=()=>{a.emit(h.destory)},i=()=>{Promise.resolve().then(()=>{a.componentRef=u})};return()=>r(X,A({ref:u,modelValue:c.value,beforeClose:m,onClosed:p,onVnodeMounted:i},{title:l.title,width:l.width,...l.attrs}),{default:()=>n,footer:()=>r("div",null,[l[N(h.cancel)]&&r(x("el-button"),{onClick:()=>a.emit(h.cancel)},{default:()=>[l.cancelBtnText||e("el.messagebox.cancel")]}),l[N(h.confirm)]&&r(x("el-button"),{type:"primary",onClick:()=>a.emit(h.confirm)},{default:()=>[l.confirmBtnText||e("el.messagebox.confirm")]})]),...l.slots})}})),{provideProps:l.provideProps||{},appendTo:l.appendTo,visible:c});return Object.entries(l).filter(([u,m])=>u.startsWith("on")&&typeof m=="function").forEach(([u,m])=>{const p=ne(u);a.on(p,m)}),a}},re={overlay:!0,round:!0,lockScroll:!0,closeable:!0,closeOnClickOverlay:!1,style:{backgroundColor:"#fff",color:"#000"}},L=(o=!0)=>{const t=E();return(s,n={})=>{const l=D(o),c=q(t,K(B({setup(){const a=D(),u=()=>{c.destroy()},m=()=>{c.emit(h.destory)},p=()=>{Promise.resolve().then(()=>{c.componentRef=a})};return()=>r(Y,A({ref:a,show:l.value,onClickCloseIcon:u,onClosed:m,onVnodeMounted:p},{...re,...n.attrs}),{default:()=>s,...n.slots})}})),{provideProps:n.provideProps||{},appendTo:n.appendTo,visible:l});return c}},ae=(o=!0)=>{const t=L(o);return(e,s={})=>{const n=r("div",{class:"w-full h-full"},[s.title&&r("div",{class:"vant-popup-title"},[r("div",{class:"vant-popup-title-text",innerHTML:s.title},null)]),e]);return t(n,s)}},ie=(o=!0)=>{const t=ae(o);return(e,s={})=>(s.attrs||(s.attrs={}),s.attrs.position="bottom",s.attrs.style.width="100vw",t(e,s))},g=B({__name:"Content",setup(o){const t=Z().query.nested==="true";P("content","来自Content的🩷~");const e=O("depth",0);P("depth",e+1);const s=te();window.dialogStack=s.stack;const n=E(),l=D();return Promise.resolve().then(()=>{l.value={...n==null?void 0:n.appContext.provides,...n.provides}}),(c,a)=>{const u=x("el-divider"),m=x("el-button");return U(),_(W,null,[r(u),a[2]||(a[2]=V("h3",null,"接收到的注入数据",-1)),V("div",null,S(l.value),1),r(u),r(m,{onClick:a[0]||(a[0]=p=>M(s).destroy())},{default:b(()=>a[1]||(a[1]=[f("弹窗内部控制关闭")])),_:1}),t?(U(),_(W,{key:0},[r(u),V("h4",null,"弹窗深度:"+S(M(e)),1),r(ue)],64)):ee("",!0)],64)}}}),ue=B({__name:"index",setup(o){P("base","来自base的🩷");const t=I(),e=()=>{t(r(g,null,null),{title:"基础用法"})},s=()=>{const{hide:p,show:i,destroyWithResolve:y}=t(r(g,null,null),{title:"外部控制"});[2,4,6].forEach(k=>{setTimeout(()=>{k===2&&p(),k===4&&i(),k===6&&y()},k*1e3)})},n=I(!1),l=()=>{const{show:p}=n(r(g,null,null),{title:"三秒后打开"});setTimeout(()=>{p()},3e3)},c=L(),a=()=>{c(r("div",{style:"color: red; height: 30vh;padding: 20px;"},[f("我是vantUi的弹窗里的内容")]))},u=ie(),m=()=>{u(r("div",{style:"color: red; height: 30vh; width: 90vw;"},[f("我是vantUi的弹窗里的内容")]),{title:"VantUi弹窗",attrs:{overlay:!1,position:"center",style:{backgroundColor:"#fff",color:"#000",width:"fit-content"}}})};return(p,i)=>{const y=x("el-button"),k=x("el-divider");return U(),_("div",null,[r(y,{type:"primary",onClick:e},{default:b(()=>i[0]||(i[0]=[f("打开弹窗")])),_:1}),r(y,{type:"success",onClick:s},{default:b(()=>i[1]||(i[1]=[f("弹窗外部控制显示/隐藏/销毁(过程中弹窗会自动显示关闭)")])),_:1}),r(y,{type:"success",onClick:l},{default:b(()=>i[2]||(i[2]=[f("三秒后打开")])),_:1}),r(k,null,{default:b(()=>i[3]||(i[3]=[f("VantUiのdemo")])),_:1}),r(y,{type:"success",onClick:a},{default:b(()=>i[4]||(i[4]=[f("打开VantUi弹窗")])),_:1}),r(y,{type:"success",onClick:m},{default:b(()=>i[5]||(i[5]=[f("打开VantUi弹窗(标题+底部弹出)")])),_:1})])}}});export{ue as _,g as a};
