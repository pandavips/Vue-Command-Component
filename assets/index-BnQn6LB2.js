import{i as k,u as I,f as b,h as S,a as f,d as T,p as g,g as x,j as M,r as w,m as R,E as A,n as W}from"./index-BDV5NLej.js";var K=Object.defineProperty,O=(t,o,e)=>o in t?K(t,o,{enumerable:!0,configurable:!0,writable:!0,value:e}):t[o]=e,V=(t,o,e)=>O(t,o+"",e);class G{constructor(){V(this,"map",new WeakMap)}getEventsMapByConsumer(o){let e=this.map.get(o);return e||(e=new Map,this.map.set(o,e)),e}getEventsByConsumer(o,e){const s=this.getEventsMapByConsumer(o);let n=s.get(e);return n||(n=new Set,s.set(e,n)),n}on(o,e,s,n={}){const d=this.getEventsByConsumer(o,e);let a=s;n.once&&(a=(...c)=>{s(...c),this.off(o,e,a)}),d.add(a),n.callAfterDelay!==void 0&&setTimeout(()=>{a()},n.callAfterDelay||0)}once(o,e,s){this.on(o,e,s,{once:!0})}emit(o,e,...s){this.getEventsByConsumer(o,e).forEach(n=>n(...s))}off(o,e,s){this.getEventsByConsumer(o,e).delete(s)}}const L=(t="")=>t.slice(2).toLowerCase(),j=(t="")=>`on${t.charAt(0).toUpperCase()}${t.slice(1)}`,U=()=>{let t=()=>{},o=()=>{};return{promise:new Promise((e,s)=>{t=e,o=s}),resolve:t,reject:o}};var m=(t=>(t.confirm="confirm",t.cancel="cancel",t.destory="destory",t))(m||{});const D=Symbol("CommandDialogConsumerInjectKey"),E=Symbol("CommandDialogStackInjectKey"),h=new G,P=t=>({...t.parent?P(t.parent):{},...t.provides});function $(t,o,e){const s=(typeof e.appendTo=="string"?document.querySelector(e.appendTo):e.appendTo)||document.body,n=document.createElement("div");s.appendChild(n);const d=()=>{e.visible.value=!1},a=()=>{e.visible.value=!0},c=()=>{W(()=>{x(null,n),n.remove()})},p=(r=!1)=>{r?(i.on(m.destory,c,{once:!0,callAfterDelay:3e3}),d()):i.stack.splice(i.stackIndex).forEach(l=>l.destroy(!0))},{promise:u,resolve:y,reject:C}=U(),i={promise:u,resolve:y,reject:C,destroyWithResolve:r=>{y(r),p()},destroyWithReject:r=>{C(r),p()},hide:d,show:a,destroy:p,container:n,visible:e.visible,on:(r,l,B={})=>h.on(i,r,l,B),once:(r,l)=>h.once(i,r,l),emit:(r,...l)=>h.emit(i,r,...l),off:(r,l)=>h.off(i,r,l),stack:[],stackIndex:-1,componentRef:void 0},v=f(T({setup(){for(const l in e.provideProps)g(l,e.provideProps[l]);g(D,i);const r=k(E,[]);return i.stackIndex=r.length,r.push(i),g(E,r),i.stack=r,()=>o}}),null,null);return v.appContext=(t==null?void 0:t.appContext)||v.appContext,v.appContext.provides={...v.appContext.provides,...P(t)},x(v,n),i}const N=(t=!0)=>{const o=()=>t&&console.warn(`别调用了欧尼酱~,这会儿没啥实际用途;没有根据CommandDialogInjectKey接收到注入数据.原因可能有两个:
    1.你可能对getCommandDialogConsumer进行了异步调用或条件调用,请在setup中直接调用.
    2.你没有在命令弹窗内展示该组件,这个时候你一般可以忽略该警告消息.`);return k(D,new Proxy({},{get:()=>o,apply:o}))},Q=(t=!0)=>{const o=M(),{locale:{t:e}}=I("message-box");return(s,n={})=>{const d=b(t),a=$(o,S(T({setup(){const c=b(),p=C=>{C(),a.destroy()},u=()=>{a.emit(m.destory)},y=()=>{Promise.resolve().then(()=>{a.componentRef=c})};return()=>f(A,R({ref:c,modelValue:d.value,beforeClose:p,onClosed:u,onVnodeMounted:y},{title:n.title,width:n.width,...n.attrs}),{default:()=>s,footer:()=>f("div",null,[n[j(m.cancel)]&&f(w("el-button"),{onClick:()=>a.emit(m.cancel)},{default:()=>[n.cancelBtnText||e("el.messagebox.cancel")]}),n[j(m.confirm)]&&f(w("el-button"),{type:"primary",onClick:()=>a.emit(m.confirm)},{default:()=>[n.confirmBtnText||e("el.messagebox.confirm")]})]),...n.slots})}})),{provideProps:n.provideProps||{},appendTo:n.appendTo,visible:d});return Object.entries(n).filter(([c,p])=>c.startsWith("on")&&typeof p=="function").forEach(([c,p])=>{const u=L(c);a.on(u,p)}),a}};export{N as Q,Q as X,m as u};
