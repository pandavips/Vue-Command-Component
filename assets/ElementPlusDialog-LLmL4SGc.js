var R=Object.defineProperty;var T=(t,o,e)=>o in t?R(t,o,{enumerable:!0,configurable:!0,writable:!0,value:e}):t[o]=e;var g=(t,o,e)=>T(t,typeof o!="symbol"?o+"":o,e);import{ad as I,ag as y,by as D,a2 as j,_ as b,$ as W,bw as K,b as w,bx as N,bq as k,aK as z,J as A}from"./index-CNGc4wGV.js";import{c as Z}from"./index-Dz9ciVy6.js";class ${constructor(){g(this,"map",new WeakMap)}getEventsMapByConsumer(o){let e=this.map.get(o);return e||(e=new Map,this.map.set(o,e)),e}getEventsByConsumer(o,e){const a=this.getEventsMapByConsumer(o);let n=a.get(e);return n||(n=new Set,a.set(e,n)),n}on(o,e,a,n={}){const s=this.getEventsByConsumer(o,e);let m=a;n.once&&(m=(...i)=>{a(...i),this.off(o,e,m)}),s.add(m),n.callAfterDelay!==void 0&&setTimeout(()=>{m()},n.callAfterDelay||0)}once(o,e,a){this.on(o,e,a,{once:!0})}emit(o,e,...a){this.getEventsByConsumer(o,e).forEach(s=>s(...a))}off(o,e,a){this.getEventsByConsumer(o,e).delete(a)}}const q=(t="")=>t.slice(2).toLowerCase(),P=(t="")=>`on${t.charAt(0).toUpperCase()}${t.slice(1)}`,G=()=>{let t=()=>{},o=()=>{};return{promise:new Promise((a,n)=>{t=a,o=n}),resolve:t,reject:o}},J=t=>{var a;const o=((a=t.parentElement)==null?void 0:a.children)||[];let e=0;return Array.from(o).forEach(n=>{if(n!==t){const s=parseInt(window.getComputedStyle(n).zIndex);!isNaN(s)&&s>e&&(e=s)}}),e};var u=(t=>(t.confirm="confirm",t.cancel="cancel",t.destory="destory",t))(u||{});const B=Symbol("CommandDialogConsumerInjectKey"),E=Symbol("CommandDialogStackInjectKey"),x=new $,M=t=>({...t.parent?M(t.parent):{},...t.provides});function L(t,o,e){const a=(typeof e.appendTo=="string"?document.querySelector(e.appendTo):e.appendTo)||document.body,n=document.createElement("div");n.className="command-commponent-container",a.appendChild(n);const s=J(n);n.style.position="relative",n.style.zIndex=String(Math.max(s+1,9999));const m=()=>{e.visible.value=!1},i=()=>{e.visible.value=!0},p=()=>{W(()=>{D(null,n),n.remove()})},d=(r=!1)=>{r?(l.on(u.destory,p,{once:!0,callAfterDelay:3e3}),m()):l.stack.splice(l.stackIndex).forEach(c=>c.destroy(!0))},{promise:v,resolve:h,reject:f}=G(),l={promise:v,resolve:h,reject:f,destroyWithResolve:r=>{h(r),d()},destroyWithReject:r=>{f(r),d()},hide:m,show:i,destroy:d,container:n,visible:e.visible,on:(r,c,S={})=>x.on(l,r,c,S),once:(r,c)=>x.once(l,r,c),emit:(r,...c)=>x.emit(l,r,...c),off:(r,c)=>x.off(l,r,c),stack:[],stackIndex:-1,componentRef:void 0},C=y(j({setup(){for(const c in e.provideProps)b(c,e.provideProps[c]);b(B,l);const r=I(E,[]);return l.stackIndex=r.length,r.push(l),b(E,r),l.stack=r,()=>o}}),null,null);return C.appContext=(t==null?void 0:t.appContext)||C.appContext,C.appContext.provides={...C.appContext.provides,...M(t)},D(C,n),l}const X=(t=!0)=>{const o=()=>t&&console.warn(`别调用了欧尼酱~,这会儿没啥实际用途;没有根据CommandDialogInjectKey接收到注入数据.原因可能有两个:
    1.你可能对getCommandDialogConsumer进行了异步调用或条件调用,请在setup中直接调用.
    2.你没有在命令弹窗内展示该组件,这个时候你一般可以忽略该警告消息.`);return I(B,()=>new Proxy({},{get:()=>o,apply:o}),!0)},Y=(t=!0)=>{const o=A(),{locale:{t:e}}=K("message-box");return(n,s={})=>{const m=w(t),i=L(o,N(j({setup(){const p=w(),d=f=>{f(),i.destroy()},v=()=>{i.emit(u.destory)},h=()=>{Promise.resolve().then(()=>{i.componentRef=p})};return()=>y(Z,z({ref:p,modelValue:m.value,beforeClose:d,onClosed:v,onVnodeMounted:h},{title:s.title,width:s.width,...s.attrs}),{default:()=>n,footer:()=>y("div",null,[s[P(u.cancel)]&&y(k("el-button"),{onClick:()=>i.emit(u.cancel)},{default:()=>[s.cancelBtnText||e("el.messagebox.cancel")]}),s[P(u.confirm)]&&y(k("el-button"),{type:"primary",onClick:()=>i.emit(u.confirm)},{default:()=>[s.confirmBtnText||e("el.messagebox.confirm")]})]),...s.slots})}})),{provideProps:s.provideProps||{},appendTo:s.appendTo,visible:m});return Object.entries(s).filter(([p,d])=>p.startsWith("on")&&typeof d=="function").forEach(([p,d])=>{const v=q(p);i.on(v,d)}),i}};export{L as C,u as E,Y as c,X as g};
