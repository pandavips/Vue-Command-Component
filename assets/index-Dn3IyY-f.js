var R=Object.defineProperty;var T=(t,o,e)=>o in t?R(t,o,{enumerable:!0,configurable:!0,writable:!0,value:e}):t[o]=e;var b=(t,o,e)=>T(t,typeof o!="symbol"?o+"":o,e);import{i as j,a as y,g as D,d as I,p as g,n as W,f as k,h as K,r as w,m as N,j as z}from"./index-ChOSWIHi.js";import{u as A,E as Z}from"./index-DHtOwdeB.js";class ${constructor(){b(this,"map",new WeakMap)}getEventsMapByConsumer(o){let e=this.map.get(o);return e||(e=new Map,this.map.set(o,e)),e}getEventsByConsumer(o,e){const r=this.getEventsMapByConsumer(o);let n=r.get(e);return n||(n=new Set,r.set(e,n)),n}on(o,e,r,n={}){const s=this.getEventsByConsumer(o,e);let m=r;n.once&&(m=(...i)=>{r(...i),this.off(o,e,m)}),s.add(m),n.callAfterDelay!==void 0&&setTimeout(()=>{m()},n.callAfterDelay||0)}once(o,e,r){this.on(o,e,r,{once:!0})}emit(o,e,...r){this.getEventsByConsumer(o,e).forEach(s=>s(...r))}off(o,e,r){this.getEventsByConsumer(o,e).delete(r)}}const q=(t="")=>t.slice(2).toLowerCase(),P=(t="")=>`on${t.charAt(0).toUpperCase()}${t.slice(1)}`,G=()=>{let t=()=>{},o=()=>{};return{promise:new Promise((r,n)=>{t=r,o=n}),resolve:t,reject:o}},L=t=>{var r;const o=((r=t.parentElement)==null?void 0:r.children)||[];let e=0;return Array.from(o).forEach(n=>{if(n!==t){const s=parseInt(window.getComputedStyle(n).zIndex);!isNaN(s)&&s>e&&(e=s)}}),e};var u=(t=>(t.confirm="confirm",t.cancel="cancel",t.destory="destory",t))(u||{});const B=Symbol("CommandDialogConsumerInjectKey"),E=Symbol("CommandDialogStackInjectKey"),x=new $,M=t=>({...t.parent?M(t.parent):{},...t.provides});function O(t,o,e){const r=(typeof e.appendTo=="string"?document.querySelector(e.appendTo):e.appendTo)||document.body,n=document.createElement("div");n.className="command-commponent-container",r.appendChild(n);const s=L(n);n.style.position="relative",n.style.zIndex=String(Math.max(s+1,9999));const m=()=>{e.visible.value=!1},i=()=>{e.visible.value=!0},p=()=>{W(()=>{D(null,n),n.remove()})},d=(a=!1)=>{a?(l.on(u.destory,p,{once:!0,callAfterDelay:3e3}),m()):l.stack.splice(l.stackIndex).forEach(c=>c.destroy(!0))},{promise:v,resolve:h,reject:f}=G(),l={promise:v,resolve:h,reject:f,destroyWithResolve:a=>{h(a),d()},destroyWithReject:a=>{f(a),d()},hide:m,show:i,destroy:d,container:n,visible:e.visible,on:(a,c,S={})=>x.on(l,a,c,S),once:(a,c)=>x.once(l,a,c),emit:(a,...c)=>x.emit(l,a,...c),off:(a,c)=>x.off(l,a,c),stack:[],stackIndex:-1,componentRef:void 0},C=y(I({setup(){for(const c in e.provideProps)g(c,e.provideProps[c]);g(B,l);const a=j(E,[]);return l.stackIndex=a.length,a.push(l),g(E,a),l.stack=a,()=>o}}),null,null);return C.appContext=(t==null?void 0:t.appContext)||C.appContext,C.appContext.provides={...C.appContext.provides,...M(t)},D(C,n),l}const X=(t=!0)=>{const o=()=>t&&console.warn(`别调用了欧尼酱~,这会儿没啥实际用途;没有根据CommandDialogInjectKey接收到注入数据.原因可能有两个:
    1.你可能对getCommandDialogConsumer进行了异步调用或条件调用,请在setup中直接调用.
    2.你没有在命令弹窗内展示该组件,这个时候你一般可以忽略该警告消息.`);return j(B,()=>new Proxy({},{get:()=>o,apply:o}),!0)},Y=(t=!0)=>{const o=z(),{locale:{t:e}}=A("message-box");return(n,s={})=>{const m=k(t),i=O(o,K(I({setup(){const p=k(),d=f=>{f(),i.destroy()},v=()=>{i.emit(u.destory)},h=()=>{Promise.resolve().then(()=>{i.componentRef=p})};return()=>y(Z,N({ref:p,modelValue:m.value,beforeClose:d,onClosed:v,onVnodeMounted:h},{title:s.title,width:s.width,...s.attrs}),{default:()=>n,footer:()=>y("div",null,[s[P(u.cancel)]&&y(w("el-button"),{onClick:()=>i.emit(u.cancel)},{default:()=>[s.cancelBtnText||e("el.messagebox.cancel")]}),s[P(u.confirm)]&&y(w("el-button"),{type:"primary",onClick:()=>i.emit(u.confirm)},{default:()=>[s.confirmBtnText||e("el.messagebox.confirm")]})]),...s.slots})}})),{provideProps:s.provideProps||{},appendTo:s.appendTo,visible:m});return Object.entries(s).filter(([p,d])=>p.startsWith("on")&&typeof d=="function").forEach(([p,d])=>{const v=q(p);i.on(v,d)}),i}};export{O as C,u as E,Y as c,X as g};
